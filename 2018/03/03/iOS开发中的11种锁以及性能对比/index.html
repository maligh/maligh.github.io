
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="记录学习中的点滴,努力打怪升级-MaLi">
    <title>iOS开发中的11种锁以及性能对比 - 记录学习中的点滴,努力打怪升级-MaLi</title>
    <meta name="author" content="Mali">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="在平时开发中我们经常会使用多线程，多线程为我们带来了很大便利，也提高了程序的执行效率，但同时也带来了Data race。">
<meta name="keywords" content="多线程">
<meta property="og:type" content="blog">
<meta property="og:title" content="iOS开发中的11种锁以及性能对比">
<meta property="og:url" content="http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/index.html">
<meta property="og:site_name" content="记录学习中的点滴,努力打怪升级-MaLi">
<meta property="og:description" content="在平时开发中我们经常会使用多线程，多线程为我们带来了很大便利，也提高了程序的执行效率，但同时也带来了Data race。">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1457495-7da10e7cbd400978.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1457495-4151d1dc7f68827e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-03-03T06:34:49.970Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS开发中的11种锁以及性能对比">
<meta name="twitter:description" content="在平时开发中我们经常会使用多线程，多线程为我们带来了很大便利，也提高了程序的执行效率，但同时也带来了Data race。">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/1457495-7da10e7cbd400978.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
    
        
    
    
        <meta property="og:image" content="http://superma.me/assets/images/avatar.jpg"/>
    
    
        <meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1457495-08155377a6b6423c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://upload-images.jianshu.io/upload_images/1457495-08155377a6b6423c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" />
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-sxklfps8ywgfyyjcowvnb4gxdgt0zjts3hsguljmv9uqanxjbnitrovtbrek.min.css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">记录学习中的点滴,努力打怪升级-MaLi</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Mali</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Objective-C &amp;&amp; Swift &amp;&amp; Python &amp;&amp; PHP’s Learner</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/maligh" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://www.jianshu.com/u/e5c4518a950d" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-leanpub"></i>
                        <span class="sidebar-button-desc">JianShu</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://www.jianshu.com/u/e5c4518a950d" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            iOS开发中的11种锁以及性能对比
        </h1>
    
    
        <div class="post-meta">
    <time itemprop="datePublished" datetime="2018-03-03T14:30:35+08:00">
	
		    Mar 03, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/Objective-C/">Objective-C</a>


    
</div>

    
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>在平时开发中我们经常会使用多线程，多线程为我们带来了很大便利，也提高了程序的执行效率，但同时也带来了<code>Data race</code>。<a id="more"></a><code>Data race</code>的定义很简单：当至少有两个线程同时访问同一个变量，而且至少其中有一个是写操作时，就发生了<code>Data race</code>。所以这是就要利用一些同步机制来确保数据的准确性，锁就是同步机制中的一种。</p>
<h2 id="怎么检测项目中的Data-race？"><a href="#怎么检测项目中的Data-race？" class="headerlink" title="怎么检测项目中的Data race？"></a>怎么检测项目中的<code>Data race</code>？</h2><p><img src="http://upload-images.jianshu.io/upload_images/1457495-7da10e7cbd400978.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>只需要在设置中勾选<code>Thread Sanitizer</code> 即可，顺便可以勾选<code>Pause on issues</code> 就可以断点到相应的代码。<br>更多延伸内容请参考Peak君的<a href="http://mrpeak.cn/blog/thread-sanitizer/" target="_blank" rel="external">如何用Xcode8解决多线程问题</a>和<a href="http://www.mrpeak.cn/blog/ios-thread-safety/" target="_blank" rel="external">iOS多线程到底不安全在哪里？</a></p>
<p>下面就进入正题简单聊一聊iOS中的锁，以及相关的内容（由于本人能力有限，文中难免有一些遗漏或者错误，请各位看官不吝赐教！谢谢！🙏)</p>
<h2 id="简单的性能测试"><a href="#简单的性能测试" class="headerlink" title="简单的性能测试"></a>简单的性能测试</h2><p>下图是我针对iOS中的锁自己测试得出的，图中数字代表每次加解锁需要消耗的时间，单位为ns。<a href="https://github.com/maligh/ML-Objective-C-Demo/tree/master/LockPerformance" target="_blank" rel="external">代码在这里</a>，代码参考自YY大神的<a href="https://blog.ibireme.com/2016/01/16/spinlock_is_unsafe_in_ios/" target="_blank" rel="external">不再安全的 OSSpinLock</a>，基本跟YY大神的图差不多😉，YY大神的单位是μs，应该是1000次的，或者写错了吧~<br><img src="http://upload-images.jianshu.io/upload_images/1457495-4151d1dc7f68827e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="LockPerformance.jpg"></p>
<ul>
<li>注：运行手机： iphone6s plus ，系统版本：11.2.2，Xcode9.2；数字的单位为ns（得出的具体数值是跑了多次取的均值）。</li>
</ul>
<p>值得注意的是：1.这个数字仅仅代表每次加解锁的耗时，并不能全方面的代表性能。2.不同的机型和系统，不同的循环次数可能结果会略微有些差异。<br>但是还是可以看出<code>@synchronized:</code>是表现最差的。</p>
<p><strong>在具体说这些锁之前，先来说几个概念定义：</strong>(参考<a href="https://www.wikipedia.org/" target="_blank" rel="external">维基百科</a>)</p>
<ol>
<li><strong>临界区：</strong>指的是一块对公共资源进行访问的代码，并非一种机制或是算法。</li>
<li><p><strong>自旋锁：</strong>是用于多线程同步的一种锁，线程反复检查锁变量是否可用。由于线程在这一过程中保持执行，因此是一种<code>忙等待</code>。一旦获取了自旋锁，线程会一直保持该锁，直至显式释放自旋锁。 自旋锁避免了进程上下文的调度开销，因此对于线程只会阻塞很短时间的场合是有效的。</p>
</li>
<li><p><strong>互斥锁（Mutex）：</strong>是一种用于多线程编程中，防止两条线程同时对同一公共资源（比如全局变量）进行读写的机制。该目的通过将代码切片成一个一个的临界区而达成。</p>
</li>
<li><p><strong>读写锁：</strong>是计算机程序的并发控制的一种同步机制，也称“共享-互斥锁”、多读者-单写者锁) 用于解决多线程对公共资源读写问题。读操作可并发重入，写操作是互斥的。 读写锁通常用互斥锁、条件变量、信号量实现。</p>
</li>
<li><p><strong>信号量（semaphore）：</strong>是一种更高级的同步机制，<code>互斥锁</code>可以说是semaphore在仅取值0/1时的特例。<code>信号量</code>可以有更多的取值空间，用来实现更加复杂的同步，而不单单是线程间互斥。</p>
</li>
<li><p><strong>条件锁：</strong>就是条件变量，当进程的某些资源要求不满足时就进入休眠，也就是锁住了。当资源被分配到了，条件锁打开，进程继续运行。</p>
</li>
</ol>
<h2 id="互斥锁"><a href="#互斥锁" class="headerlink" title="互斥锁"></a>互斥锁</h2><p><strong>1.NSLock：</strong>是Foundation框架中以对象形式暴露给开发者的一种锁，（Foundation框架同时提供了<code>NSConditionLock</code>，<code>NSRecursiveLock</code>，<code>NSCondition</code>）<code>NSLock</code>定义如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">@protocol NSLocking</div><div class="line"></div><div class="line">- (void)lock;</div><div class="line">- (void)unlock;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@interface NSLock : NSObject &lt;NSLocking&gt; &#123;</div><div class="line">@private</div><div class="line">    void *_priv;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (BOOL)tryLock;</div><div class="line">- (BOOL)lockBeforeDate:(NSDate *)limit;</div><div class="line"></div><div class="line">@property (nullable, copy) NSString *name API_AVAILABLE(macos(10.5), ios(2.0), watchos(2.0), tvos(9.0));</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure></p>
<p>tryLock 和 lock 方法都会请求加锁，唯一不同的是trylock在没有获得锁的时候可以继续做一些任务和处理。lockBeforeDate方法也比较简单，就是在limit时间点之前获得锁，没有拿到返回NO。<br><strong>实际项目中：</strong>NSLock在<a href="https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFURLSessionManager.m" target="_blank" rel="external">AFNetworking的AFURLSessionManager.m</a>中应用如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">- (instancetype)initWithSessionConfiguration:(NSURLSessionConfiguration *)configuration &#123;</div><div class="line">    ...</div><div class="line">    self.lock = [[NSLock alloc] init];</div><div class="line">    self.lock.name = AFURLSessionManagerLockName;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line">- (void)setDelegate:(AFURLSessionManagerTaskDelegate *)delegate</div><div class="line">            forTask:(NSURLSessionTask *)task</div><div class="line">&#123;</div><div class="line">    ...</div><div class="line">    [self.lock lock];</div><div class="line">    self.mutableTaskDelegatesKeyedByTaskIdentifier[@(task.taskIdentifier)] = delegate;</div><div class="line">    [delegate setupProgressForTask:task];</div><div class="line">    [self addNotificationObserverForTask:task];</div><div class="line">    [self.lock unlock];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>2.pthread_mutex：</strong><br><strong>实际项目中：</strong> 在<a href="https://github.com/ibireme/YYKit/blob/3869686e0e560db0b27a7140188fad771e271508/YYKit/Cache/YYMemoryCache.m" target="_blank" rel="external">YYKit的YYMemoryCach中可以看到</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">- (instancetype)init &#123;</div><div class="line">    ...</div><div class="line">    pthread_mutex_init(&amp;_lock, NULL);</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line">- (void)_trimToCost:(NSUInteger)costLimit &#123;</div><div class="line">    BOOL finish = NO;</div><div class="line">    pthread_mutex_lock(&amp;_lock);</div><div class="line">    if (costLimit == 0) &#123;</div><div class="line">        [_lru removeAll];</div><div class="line">        finish = YES;</div><div class="line">    &#125; else if (_lru-&gt;_totalCost &lt;= costLimit) &#123;</div><div class="line">        finish = YES;</div><div class="line">    &#125;</div><div class="line">    pthread_mutex_unlock(&amp;_lock);</div><div class="line">    if (finish) return;</div><div class="line">    </div><div class="line">    NSMutableArray *holder = [NSMutableArray new];</div><div class="line">    while (!finish) &#123;</div><div class="line">        if (pthread_mutex_trylock(&amp;_lock) == 0) &#123;</div><div class="line">            if (_lru-&gt;_totalCost &gt; costLimit) &#123;</div><div class="line">                _YYLinkedMapNode *node = [_lru removeTailNode];</div><div class="line">                if (node) [holder addObject:node];</div><div class="line">            &#125; else &#123;</div><div class="line">                finish = YES;</div><div class="line">            &#125;</div><div class="line">            pthread_mutex_unlock(&amp;_lock);</div><div class="line">        &#125; else &#123;</div><div class="line">            usleep(10 * 1000); //10 ms</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">   ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>3.@synchronized:</strong><br><strong>实际项目中：</strong>AFNetworking中 isNetworkActivityOccurring属性的getter方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (BOOL)isNetworkActivityOccurring &#123;</div><div class="line">    @synchronized(self) &#123;</div><div class="line">        return self.activityCount &gt; 0;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>关于 @synchronized推荐扩展阅读  <a href="http://yulingtianxia.com/blog/2015/11/01/More-than-you-want-to-know-about-synchronized/" target="_blank" rel="external">关于 @synchronized，这儿比你想知道的还要多</a></p>
<h2 id="自旋锁"><a href="#自旋锁" class="headerlink" title="自旋锁"></a>自旋锁</h2><p><strong>1.OSSpinLock:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">OSSpinLock lock = OS_SPINLOCK_INIT;</div><div class="line">OSSpinLockLock(&amp;lock);</div><div class="line">...</div><div class="line">OSSpinLockUnlock(&amp;lock);</div></pre></td></tr></table></figure></p>
<p>上面是OSSpinLock使用方式，编译会报警告，已经废弃了，OSSpinLock大家也已经不再用它了，因为它在某一些场景下已经不安全了，可以参考 YY大神的<a href="https://blog.ibireme.com/2016/01/16/spinlock_is_unsafe_in_ios/" target="_blank" rel="external">不再安全的 OSSpinLock</a>，在Protocol Buffers项目中你可以看到这样的注释，大家已经用新的方案替换了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// NOTE: OSSpinLock may seem like a good fit here but Apple engineers have</div><div class="line"> // pointed out that they are vulnerable to live locking on iOS in cases of</div><div class="line"> // priority inversion:</div><div class="line"> //   http://mjtsai.com/blog/2015/12/16/osspinlock-is-unsafe/</div><div class="line"> //   https://lists.swift.org/pipermail/swift-dev/Week-of-Mon-20151214/000372.html</div></pre></td></tr></table></figure></p>
<p><strong>2.os_unfair_lock:</strong><br>os_unfair_lock 是苹果官方推荐的替换OSSpinLock的方案，但是它在iOS10.0以上的系统才可以调用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">os_unfair_lock_t unfairLock;</div><div class="line">unfairLock = &amp;(OS_UNFAIR_LOCK_INIT);</div><div class="line">os_unfair_lock_lock(unfairLock);</div><div class="line">os_unfair_lock_unlock(unfairLock);</div></pre></td></tr></table></figure></p>
<h2 id="读写锁"><a href="#读写锁" class="headerlink" title="读写锁"></a>读写锁</h2><p>上文有说到，读写锁又称共享-互斥锁，<br><strong>pthread_rwlock：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//加读锁</div><div class="line">pthread_rwlock_rdlock(&amp;rwlock);</div><div class="line">//解锁</div><div class="line">pthread_rwlock_unlock(&amp;rwlock);</div><div class="line">//加写锁</div><div class="line">pthread_rwlock_wrlock(&amp;rwlock);</div><div class="line">//解锁</div><div class="line">pthread_rwlock_unlock(&amp;rwlock);</div></pre></td></tr></table></figure></p>
<h2 id="递归锁"><a href="#递归锁" class="headerlink" title="递归锁"></a>递归锁</h2><p>递归锁有一个特点，就是同一个线程可以加锁N次而不会引发死锁。<br><strong>1.NSRecursiveLock:</strong><br>NSRecursiveLock在<a href="https://github.com/ibireme/YYKit/blob/4e1bd1cfcdb3331244b219cbd37cc9b1ccb62b7a/YYKit/Image/YYWebImageOperation.m" target="_blank" rel="external">YYKit中YYWebImageOperation.m</a>中有用到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">_lock = [NSRecursiveLock new];</div><div class="line">- (void)dealloc &#123;</div><div class="line">    [_lock lock];</div><div class="line">    ...</div><div class="line">    ...</div><div class="line">    [_lock unlock];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>2.pthread_mutex(recursive):</strong><br>pthread_mutex锁也支持递归，只需要设置PTHREAD_MUTEX_RECURSIVE即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">pthread_mutex_t lock;</div><div class="line">pthread_mutexattr_t attr;</div><div class="line">pthread_mutexattr_init(&amp;attr);</div><div class="line">pthread_mutexattr_settype(&amp;attr, PTHREAD_MUTEX_RECURSIVE);</div><div class="line">pthread_mutex_init(&amp;lock, &amp;attr);</div><div class="line">pthread_mutexattr_destroy(&amp;attr);</div><div class="line">pthread_mutex_lock(&amp;lock);</div><div class="line">pthread_mutex_unlock(&amp;lock);</div></pre></td></tr></table></figure></p>
<h2 id="条件锁"><a href="#条件锁" class="headerlink" title="条件锁"></a>条件锁</h2><p><strong>1. NSCondition:</strong><br><strong>定义：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">@interface NSCondition : NSObject &lt;NSLocking&gt; &#123;</div><div class="line">@private</div><div class="line">    void *_priv;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)wait;</div><div class="line">- (BOOL)waitUntilDate:(NSDate *)limit;</div><div class="line">- (void)signal;</div><div class="line">- (void)broadcast;</div></pre></td></tr></table></figure></p>
<p>遵循NSLocking协议，使用的时候同样是lock,unlock加解锁，wait是傻等，waitUntilDate:方法是等一会，都会阻塞掉线程，signal是唤起一个在等待的线程，broadcast是广播全部唤起。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">NSCondition *lock = [[NSCondition alloc] init];</div><div class="line">//Son 线程</div><div class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">    [lock lock];</div><div class="line">    while (No Money) &#123;</div><div class="line">        [lock wait];</div><div class="line">    &#125;</div><div class="line">    NSLog(@&quot;The money has been used up.&quot;);</div><div class="line">    [lock unlock];</div><div class="line">&#125;);</div><div class="line">    </div><div class="line"> //Father线程</div><div class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">    [lock lock];</div><div class="line">    NSLog(@&quot;Work hard to make money.&quot;);</div><div class="line">    [lock signal];</div><div class="line">    [lock unlock];</div><div class="line"> &#125;);</div></pre></td></tr></table></figure></p>
<p><strong>2.NSConditionLock:</strong><br><strong>定义：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">@interface NSConditionLock : NSObject &lt;NSLocking&gt; &#123;</div><div class="line">@private</div><div class="line">    void *_priv;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (instancetype)initWithCondition:(NSInteger)condition NS_DESIGNATED_INITIALIZER;</div><div class="line"></div><div class="line">@property (readonly) NSInteger condition;</div><div class="line">- (void)lockWhenCondition:(NSInteger)condition;</div><div class="line">- (BOOL)tryLock;</div><div class="line">- (BOOL)tryLockWhenCondition:(NSInteger)condition;</div><div class="line">- (void)unlockWithCondition:(NSInteger)condition;</div><div class="line">- (BOOL)lockBeforeDate:(NSDate *)limit;</div><div class="line">- (BOOL)lockWhenCondition:(NSInteger)condition beforeDate:(NSDate *)limit;</div></pre></td></tr></table></figure></p>
<p>很简单，方法很清晰，基本同上。</p>
<h2 id="信号量"><a href="#信号量" class="headerlink" title="信号量"></a>信号量</h2><p><strong>dispatch_semaphore:</strong><br>dispatch_semaphore在YYKit中的<a href="https://github.com/ibireme/YYKit/blob/3869686e0e560db0b27a7140188fad771e271508/YYKit/Utility/YYThreadSafeArray.m" target="_blank" rel="external">YYThreadSafeArray.m</a>有所应用，YY大神有这样一句注释：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@discussion Generally, access performance is lower than NSMutableArray, </div><div class="line"> but higher than using @synchronized, NSLock, or pthread_mutex_t.</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#define LOCK(...) dispatch_semaphore_wait(_lock, DISPATCH_TIME_FOREVER); \</div><div class="line">__VA_ARGS__; \</div><div class="line">dispatch_semaphore_signal(_lock);</div></pre></td></tr></table></figure>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>其实本文写的都是一些再基础不过的内容，在平时阅读一些开源项目的时候经常会遇到一些保持线程同步的方式，因为场景不同可能选型不同，这篇就做一下简单的记录吧~我相信读完这篇你应该能根据不同场景选择合适的锁了吧、能够道出<code>自旋锁</code>和<code>互斥锁</code>的区别了吧。</p>
<h2 id="最后："><a href="#最后：" class="headerlink" title="最后："></a>最后：</h2><p>由于本人能力有限，文中难免有一些遗漏或者错误，请各位看官不吝赐教！谢谢！同时有任何关于锁相关的疑问可以疯狂留言，一起交流，一起进步~🙏 祝大家每天都能进步一点点~</p>
<h2 id="扩展阅读："><a href="#扩展阅读：" class="headerlink" title="扩展阅读："></a>扩展阅读：</h2><ol>
<li><a href="https://blog.ibireme.com/2016/01/16/spinlock_is_unsafe_in_ios/" target="_blank" rel="external">不再安全的 OSSpinLock</a>🔥🔥</li>
<li><a href="https://juejin.im/post/57f6e9f85bbb50005b126e5f" target="_blank" rel="external">深入理解 iOS 开发中的锁</a>🔥🔥</li>
<li><a href="http://yulingtianxia.com/blog/2015/11/01/More-than-you-want-to-know-about-synchronized/" target="_blank" rel="external">关于 @synchronized，这儿比你想知道的还要多</a>🔥🔥🔥</li>
<li><a href="https://casatwy.com/pthreadde-ge-chong-tong-bu-ji-zhi.html" target="_blank" rel="external">pthread的各种同步机制- Casa Taloyum</a>🔥🔥</li>
<li><a href="https://developer.apple.com/library/prerelease/content/documentation/Cocoa/Conceptual/Multithreading/Introduction/Introduction.html#//apple_ref/doc/uid/10000057" target="_blank" rel="external">Threading Programming Guide</a></li>
</ol>

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/all-tags/多线程/">多线程</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/02/04/提升iOS开发效率的一些keys/" data-tooltip="提升iOS开发效率的一些keys">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-weibo"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/&amp;title=iOS开发中的11种锁以及性能对比">
                    <i class="fa fa-qq"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-star"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-renren"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Mali. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/02/04/提升iOS开发效率的一些keys/" data-tooltip="提升iOS开发效率的一些keys">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-weibo"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/&amp;title=iOS开发中的11种锁以及性能对比">
                    <i class="fa fa-qq"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-star"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-renren"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-twitter"></i><span>Share on Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-google-plus"></i><span>Share on Google+</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?&amp;title=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-weibo"></i><span>Share on Weibo</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/&amp;title=iOS开发中的11种锁以及性能对比">
                    <i class="fa fa-qq"></i><span>Share on QQ</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-star"></i><span>Share on Qzone</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                    <i class="fa fa-renren"></i><span>Share on Renren</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Mali</h4>
        
            <div id="about-card-bio"><p>Objective-C &amp;&amp; Swift &amp;&amp; Python &amp;&amp; PHP’s Learner</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>iOS Developer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                ShenZhen
            </div>
        
    </div>
</div>

        <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-close"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2016/04/30/post/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-df0b95375604d34b.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2016/04/30/post/">
                            <h3 class="media-heading">iOS常量(const)、enum、宏(#define)的使用场景及区别</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 30, 2016
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>前言：本文主要梳理iOS中如何使用常量、enum、宏，以及各自的使用场景。<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/07/04/Objective-C编程规范以及建议/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-ad0b17b8f89cc097.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/07/04/Objective-C编程规范以及建议/">
                            <h3 class="media-heading">Objective-C编程规范以及建议</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 4, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>本文记录一下Objective-C编程规范以及一些建议，可能后续会有些修改和补充，至于初衷是最近接手的项目中代码”有些”凌乱，所以整理了一篇，有一些来自网上，有一些是我平时的代码风格的吧~<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/07/30/iOS理解Objective-C中消息转发机制附Demo/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-ade801c636fc86fc.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/07/30/iOS理解Objective-C中消息转发机制附Demo/">
                            <h3 class="media-heading">iOS理解Objective-C中消息转发机制附Demo</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jul 30, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>最近在重温Effective Objective-C 2.0，这篇文章属于重温的产物吧，本文会通过demo来讲解OC中的消息转发机制</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/08/06/重温《EffectiveObjective-C2-0编写高质量iOS与OSX代码的52个有效方法》/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-debf9e0c37687e51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/08/06/重温《EffectiveObjective-C2-0编写高质量iOS与OSX代码的52个有效方法》/">
                            <h3 class="media-heading">重温《EffectiveObjective-C2.0编写高质量iOS与OSX代码的52个有效方法》</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Aug 6, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>最近在重温这本OC经典之作《Effective Objective-C 2.0编写高质量iOS与OS X代码的52个有效方法》，这篇文章算是重温之后的产物吧</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/08/22/iOS设计模式四部曲一创建型模式内附Demo/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-b27a7821529beb5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/08/22/iOS设计模式四部曲一创建型模式内附Demo/">
                            <h3 class="media-heading">iOS设计模式四部曲一创建型模式内附Demo</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Aug 22, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>  最近刚重温完经典书籍<a href="http://www.jianshu.com/p/862b064e82e0" target="_blank" rel="external">《EffectiveObjective-C2.0编写高质量iOS与OSX代码的52个有效方法》</a>，接下来准备把设计模式扫扫盲</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/09/05/iOS设计模式四部曲二-结构型模式内附Demo/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-9bef37686fbfa917.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/09/05/iOS设计模式四部曲二-结构型模式内附Demo/">
                            <h3 class="media-heading">iOS设计模式四部曲二:结构型模式内附Demo</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Sep 5, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p> 本篇是四部曲的第二篇，第一篇请点这里<a href="http://www.jianshu.com/p/55f0e3b30e9c" target="_blank" rel="external">iOS设计模式四部曲(一):创建型模式 内附Demo</a>，关于设计模式强烈推荐图书《Head First设计模式》以及《研磨设计模式》</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/10/18/iOS设计模式四部曲三-行为型模式内附Demo/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-2239f396849b8fc9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/10/18/iOS设计模式四部曲三-行为型模式内附Demo/">
                            <h3 class="media-heading">iOS设计模式四部曲三:行为型模式内附Demo</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Oct 18, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p> 本篇是四部曲的第三篇，第一篇请点这里<a href="http://www.jianshu.com/p/55f0e3b30e9c" target="_blank" rel="external">iOS设计模式四部曲(一):创建型模式</a>,第二篇请点击这里<a href="http://www.jianshu.com/p/8ae41a48021b" target="_blank" rel="external">iOS设计模式四部曲(二):结构型模式</a>。</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2017/12/31/2017年终总结/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-7dd518bf11850849.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2017/12/31/2017年终总结/">
                            <h3 class="media-heading">2017年终总结</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 31, 2017
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>转眼2017年走到了尾声，之前很少有写<code>年终总结</code>，如今已到了奔三的年纪，肩上的责任也越来越‘丰富’，每年做个总结，尽量避免每年‘瞎忙’吧。</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2018/02/04/提升iOS开发效率的一些keys/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-082a6ea037b27c99.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2018/02/04/提升iOS开发效率的一些keys/">
                            <h3 class="media-heading">提升iOS开发效率的一些keys</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Feb 4, 2018
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>首先题目写的有点大，这篇文章只是分享一下我平时用到的一些快捷键和习惯，希望能对大家平时的开发效率有所帮助。</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                            <img class="media-image" src="http://upload-images.jianshu.io/upload_images/1457495-08155377a6b6423c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://superma.me/2018/03/03/iOS开发中的11种锁以及性能对比/">
                            <h3 class="media-heading">iOS开发中的11种锁以及性能对比</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Mar 3, 2018
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>在平时开发中我们经常会使用多线程，多线程为我们带来了很大便利，也提高了程序的执行效率，但同时也带来了<code>Data race</code>。</div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="no post found"
                data-message-one="1 post found"
                data-message-other="{n} posts found">
                10 posts found
            </p>
        </div>
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-ivwiy10zeb8fifc4swnhkwneuk64y53w2scmdmtp8thi9cqfxh31aowtroaz.min.js"></script>
<!--SCRIPTS END-->

    


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('Z7A3XW4R2I', '12db1ad54372045549ef465881c17e743');
        var algoliaIndex = algoliaClient.initIndex('tranquilpeak');
    </script>

    </body>
</html>
